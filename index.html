<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Flipbook PDF A3 Vertical</title>
<link rel="stylesheet" href="style.css">

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Turn.js local -->
<script src="js/turn.min.js"></script>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';
</script>

<!-- Hammer.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
</head>
<body>

<h1>Flipbook PDF A3 Vertical</h1>
<div class="container">
    <div id="flipbook"></div>
</div>

<script>
const url = 'pdf/mon-document.pdf';
const flipbook = $("#flipbook");

pdfjsLib.getDocument(url).promise.then(pdf => {
    pdf.getPage(1).then(firstPage => {
        const viewport = firstPage.getViewport({ scale: 2.0 });
        const pageWidth = viewport.width;
        const pageHeight = viewport.height;

        // Cr√©er flipbook avec dimensions exactes
        flipbook.turn({
            width: pageWidth,
            height: pageHeight,
            autoCenter: true
        });

        // Charger toutes les pages
        for(let i = 1; i <= pdf.numPages; i++){
            pdf.getPage(i).then(page => {
                const vp = page.getViewport({ scale: 2.0 });
                const canvas = document.createElement("canvas");
                canvas.width = vp.width;
                canvas.height = vp.height;

                page.render({ canvasContext: canvas.getContext("2d"), viewport: vp }).promise.then(()=>{
                    const div = $('<div class="page"></div>').append(canvas);

                    // Overlays clic gauche/droite avec effet visuel
                    const overlayLeft = $('<div class="page-overlay left"></div>');
                    const overlayRight = $('<div class="page-overlay right"></div>');
                    overlayLeft.click(()=> flipbook.turn("previous"));
                    overlayRight.click(()=> flipbook.turn("next"));
                    div.append(overlayLeft, overlayRight);

                    flipbook.append(div);
                });
            });
        }

        // Zoom tactile
        const hammertime = new Hammer(flipbook[0]);
        hammertime.get("pinch").set({ enable: true });
        let zoomScale = 1;
        hammertime.on("pinch", ev => {
            zoomScale = Math.min(Math.max(zoomScale * ev.scale, 0.5), 3);
            flipbook.css("transform", `scale(${zoomScale})`);
            flipbook.css("transform-origin", "top center");
        });

        // Zoom molette
        flipbook.on("wheel", e => {
            e.preventDefault();
            zoomScale += e.originalEvent.deltaY < 0 ? 0.1 : -0.1;
            zoomScale = Math.min(Math.max(zoomScale, 0.5), 3);
            flipbook.css("transform", `scale(${zoomScale})`);
        });
    });
});
</script>
</body>
</html>

